<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrador - Patitas Felices</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <div class="dashboard">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>游 Admin Panel</h2>
                <p id="admin-name" style="font-size: 0.9rem; opacity: 0.8;"></p>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" class="active" data-section="home">Dashboard</a></li>
                <li><a href="#" data-section="users">Usuarios</a></li>
                <li><a href="#" data-section="donations">Donaciones</a></li>
                <li><a href="#" data-section="requests">Solicitudes</a></li>
                <li><a href="#" data-section="inventory">Inventario</a></li>
                <li><a href="#" id="logoutBtn" style="color: var(--danger-color);">Cerrar Sesi칩n</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div id="alert-container"></div>

            <!-- Dashboard Home -->
            <section id="home-section" class="content-section">
                <h2>Dashboard General</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="total-users">0</h3>
                        <p>Total Usuarios</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="total-donations">0</h3>
                        <p>Donaciones Totales</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="total-requests">0</h3>
                        <p>Solicitudes Totales</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="total-inventory">0</h3>
                        <p>Art칤culos en Inventario</p>
                    </div>
                </div>

                <div class="stats-grid" style="margin-top: 2rem;">
                    <div class="stat-card">
                        <h3 id="pending-donations">0</h3>
                        <p>Donaciones Pendientes</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="pending-requests">0</h3>
                        <p>Solicitudes Pendientes</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="active-users">0</h3>
                        <p>Usuarios Activos</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="low-stock">0</h3>
                        <p>Art칤culos con Bajo Stock</p>
                    </div>
                </div>
            </section>

            <!-- Secci칩n Usuarios -->
            <section id="users-section" class="content-section" style="display: none;">
                <h2>Administrar Usuarios</h2>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Rol</th>
                                <th>Estado</th>
                                <th>Fecha Registro</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="users-tbody">
                            <tr><td colspan="6" style="text-align: center;">Cargando...</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Secci칩n Donaciones -->
            <section id="donations-section" class="content-section" style="display: none;">
                <h2>Administrar Donaciones</h2>
                
                <div class="form-group" style="max-width: 300px;">
                    <label for="donation-status-filter">Filtrar por Estado</label>
                    <select id="donation-status-filter" onchange="loadDonations()">
                        <option value="">Todos</option>
                        <option value="pendiente">Pendiente</option>
                        <option value="aceptada">Aceptada</option>
                        <option value="rechazada">Rechazada</option>
                        <option value="recibida">Recibida</option>
                    </select>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Usuario</th>
                                <th>Art칤culo</th>
                                <th>Categor칤a</th>
                                <th>Cantidad</th>
                                <th>Estado</th>
                                <th>Fecha</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="donations-tbody">
                            <tr><td colspan="7" style="text-align: center;">Cargando...</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Secci칩n Solicitudes -->
            <section id="requests-section" class="content-section" style="display: none;">
                <h2>Administrar Solicitudes</h2>
                
                <div class="form-group" style="max-width: 300px;">
                    <label for="request-status-filter">Filtrar por Estado</label>
                    <select id="request-status-filter" onchange="loadRequests()">
                        <option value="">Todos</option>
                        <option value="pendiente">Pendiente</option>
                        <option value="aceptada">Aceptada</option>
                        <option value="rechazada">Rechazada</option>
                        <option value="enviada">Enviada</option>
                        <option value="recibida">Recibida</option>
                    </select>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Usuario</th>
                                <th>Art칤culo</th>
                                <th>Cantidad</th>
                                <th>Estado</th>
                                <th>Fecha</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="requests-tbody">
                            <tr><td colspan="6" style="text-align: center;">Cargando...</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Secci칩n Inventario -->
            <section id="inventory-section" class="content-section" style="display: none;">
                <h2>Administrar Inventario</h2>
                
                <button class="btn-primary" onclick="showAddInventoryModal()">+ Agregar Art칤culo</button>
                
                <div class="table-container" style="margin-top: 2rem;">
                    <table>
                        <thead>
                            <tr>
                                <th>Art칤culo</th>
                                <th>Categor칤a</th>
                                <th>Cantidad</th>
                                <th>Unidad</th>
                                <th>Disponible</th>
                                <th>칔ltima Actualizaci칩n</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-tbody">
                            <tr><td colspan="7" style="text-align: center;">Cargando...</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal Cambiar Estado Donaci칩n -->
    <div id="donation-status-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Cambiar Estado de Donaci칩n</h3>
                <button type="button" class="modal-close" onclick="closeDonationStatusModal()" aria-label="Cerrar modal">&times;</button>
            </div>
            <form id="donation-status-form">
                <input type="hidden" id="donation-id">
                
                <div class="form-group">
                    <label for="donation-info">Donaci칩n</label>
                    <input type="text" id="donation-info" disabled>
                </div>
                
                <div class="form-group">
                    <label for="donation-new-status">Nuevo Estado *</label>
                    <select id="donation-new-status" required>
                        <option value="pendiente">Pendiente</option>
                        <option value="aceptada">Aceptada</option>
                        <option value="rechazada">Rechazada</option>
                        <option value="recibida">Recibida</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="donation-notes">Notas</label>
                    <textarea id="donation-notes" placeholder="Comentarios opcionales..."></textarea>
                </div>
                
                <button type="submit" class="btn-primary" style="width: 100%;">Actualizar Estado</button>
            </form>
        </div>
    </div>

    <!-- Modal Cambiar Estado Solicitud -->
    <div id="request-status-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Cambiar Estado de Solicitud</h3>
                <button type="button" class="modal-close" onclick="closeRequestStatusModal()" aria-label="Cerrar modal">&times;</button>
            </div>
            <form id="request-status-form">
                <input type="hidden" id="request-id">
                
                <div class="form-group">
                    <label for="request-info">Solicitud</label>
                    <input type="text" id="request-info" disabled>
                </div>
                
                <div class="form-group">
                    <label for="request-new-status">Nuevo Estado *</label>
                    <select id="request-new-status" required>
                        <option value="pendiente">Pendiente</option>
                        <option value="aceptada">Aceptada</option>
                        <option value="rechazada">Rechazada</option>
                        <option value="enviada">Enviada</option>
                        <option value="recibida">Recibida</option>
                    </select>
                </div>
                
                <div class="form-group" id="reject-reason-group" style="display: none;">
                    <label for="request-reject-reason">Motivo de Rechazo *</label>
                    <textarea id="request-reject-reason" placeholder="Explica por qu칠 se rechaza..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="request-notes">Notas</label>
                    <textarea id="request-notes" placeholder="Comentarios opcionales..."></textarea>
                </div>
                
                <button type="submit" class="btn-primary" style="width: 100%;">Actualizar Estado</button>
            </form>
        </div>
    </div>

    <!-- Modal Editar Usuario -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Usuario</h3>
                <button type="button" class="modal-close" onclick="closeUserModal()" aria-label="Cerrar modal">&times;</button>
            </div>
            <form id="user-form">
                <input type="hidden" id="user-id">
                
                <div class="form-group">
                    <label for="user-nombre">Nombre *</label>
                    <input type="text" id="user-nombre" required>
                </div>
                
                <div class="form-group">
                    <label for="user-email">Email *</label>
                    <input type="email" id="user-email" required>
                </div>
                
                <div class="form-group">
                    <label for="user-telefono">Tel칠fono</label>
                    <input type="tel" id="user-telefono" maxlength="10">
                </div>
                
                <div class="form-group">
                    <label for="user-rol">Rol *</label>
                    <select id="user-rol" required>
                        <option value="usuario">Usuario</option>
                        <option value="administrador">Administrador</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="user-activo">Estado *</label>
                    <select id="user-activo" required>
                        <option value="true">Activo</option>
                        <option value="false">Inactivo</option>
                    </select>
                </div>
                
                <button type="submit" class="btn-primary" style="width: 100%;">Actualizar Usuario</button>
            </form>
        </div>
    </div>

    <!-- Modal Agregar/Editar Inventario -->
    <div id="inventory-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="inventory-modal-title">Agregar Art칤culo</h3>
                <button type="button" class="modal-close" onclick="closeInventoryModal()" aria-label="Cerrar modal">&times;</button>
            </div>
            <form id="inventory-form">
                <input type="hidden" id="inventory-id">
                
                <div class="form-group">
                    <label for="inventory-nombre">Nombre del Art칤culo *</label>
                    <input type="text" id="inventory-nombre" required>
                </div>
                
                <div class="form-group">
                    <label for="inventory-categoria">Categor칤a *</label>
                    <select id="inventory-categoria" required>
                        <option value="">Seleccionar...</option>
                        <option value="alimento_perros">Alimento para Perros</option>
                        <option value="alimento_gatos">Alimento para Gatos</option>
                        <option value="juguetes">Juguetes</option>
                        <option value="medicamentos">Medicamentos</option>
                        <option value="accesorios">Accesorios</option>
                        <option value="mantas">Mantas</option>
                        <option value="otros">Otros</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="inventory-cantidad">Cantidad *</label>
                    <input type="number" id="inventory-cantidad" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="inventory-unidad">Unidad *</label>
                    <select id="inventory-unidad" required>
                        <option value="">Seleccionar...</option>
                        <option value="kg">Kilogramos</option>
                        <option value="unidades">Unidades</option>
                        <option value="litros">Litros</option>
                        <option value="paquetes">Paquetes</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="inventory-descripcion">Descripci칩n</label>
                    <textarea id="inventory-descripcion"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="inventory-disponible">Disponible *</label>
                    <select id="inventory-disponible" required>
                        <option value="true">S칤</option>
                        <option value="false">No</option>
                    </select>
                </div>
                
                <button type="submit" class="btn-primary" style="width: 100%;">Guardar</button>
            </form>
        </div>
    </div>

    <script src="../js/api.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/admin-dashboard.js"></script>
</body>
</html>